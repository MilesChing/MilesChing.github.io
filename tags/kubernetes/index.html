<!DOCTYPE html>
<html lang="en">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<title>Kubernetes - MilesChing</title>

<meta name="description"
    content="Kubernetes - MilesChing">
<meta name="author" content="Zhengrui Qin">
<link rel="canonical" href="https://MilesChing.github.io/tags/kubernetes/" />
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<link href="https://MilesChing.github.io/css/stylesheet.min.b586bb73b58454ff4b718aeeac706dc5905a304180a33507fa016cb1ce2c87f3.css" integrity="sha256-tYa7c7WEVP9LcYrurHBtxZBaMEGAozUH&#43;gFssc4sh/M=" rel="preload stylesheet"
    as="style">

<link rel="apple-touch-icon" href="https://MilesChing.github.io/apple-touch-icon.png">
<link rel="icon" href="https://MilesChing.github.io/favicon.ico">
<meta name="generator" content="Hugo 0.68.3" />
<link rel="alternate" type="application/rss+xml" href="https://MilesChing.github.io/tags/kubernetes/index.xml" title="MilesChing" />
</head>

<body class="list" id="top">
<script>
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }
</script>
<header class="header">
    <nav class="nav">
        <p class="logo"><a href="https://MilesChing.github.io/">MilesChing</a></p>
        <ul class="menu" id="menu" onscroll="menu_on_scroll()">
            <li>
                <a href="https://MilesChing.github.io/posts/">
                    <span>
                        Posts
                    </span>
                </a>
            </li>
            <li>
                <a href="https://MilesChing.github.io/tags/">
                    <span>
                        Tags
                    </span>
                </a>
            </li>
        </ul>
    </nav>
</header>
    <main class="main"> 
<header class="page-header">
  <h1>Kubernetes</h1>
</header>


<article class="post-entry">
  <figure class="entry-cover">
    <img src="https://cdn.lynda.com/static/landing/images/hero/MasterCloudNativeInfrastructurewithKubernetes_LP_1200x630-1548277017303.jpg" alt="cover image for Kubernetes Controller：从 ReplicaSet 开始">
  </figure>
  <header class="entry-header">
    <h2>
      Kubernetes Controller：从 ReplicaSet 开始
    </h2>
  </header>
  <section class="entry-content">
    <p>在 Kubernetes Control Plane 提供的多个原生工作负载（Workload）中，ReplicaSet 是最简单和基础的一个。本文对 Kubernetes Controller 的普适性结构设计和其中一部分细节作了介绍，并借此对 ReplicaSet Controller 的源代码进行了分析。
Kubernetes 控制平台 Kubernetes 的声明式（Declarative）接口不仅是与命令式接口并列的某种交互方法，而是深深根植于它控制平台的全部设计。在这个声明式交互的系统中，系统管理员通过声明对象（Object）将自己期望的行为或运行方式告知系统，系统通过对现有对象的观察和解析不断改变自己的行为。这里的对象即 Storage 中的一个 Structure，其各字段和语义都已事先被系统和使用者约定，管理员与系统的交互方式并非通过命令语句而仅仅通过对这些 Structure 的创建、删除和修改。对于每种不同的 Structure 类型，Kubernetes 通过一个对应的 Controller 来处理上述观察、解析和系统行为的调整。
 在机器人技术和自动化技术中，控制循环是调节系统状态的无终止循环。
 Kubernetes Controller 是监视集群状态的控制循环，在每个循环中根据需要做出或请求更改。每个 Controller 监控至少一个 Kubernetes 资源类型，负责其全部对象实例的正常功能，试图做出行为将当前的集群状态移动到更接近期望的状态。这些对象一般具有表示所需状态的 Spec 字段和表示当前状态的 Status 字段。Spec 是让用户写入期望的状态，系统可以通过 Spec 读出用户的期望。Status 是系统写入观察到的状态，用户可以从中读出系统当前是什么状态。Controller 用以维护集群的这些 “行为” 绝大多数通过调用 API Server 得以完成，且大多数同样是基于声明式系统的。举例来说，ReplicaSet 是一个负责调整 Container 数量的 Controller ，但它在需要创建和删除 Container 时仅仅需要在数据库中创建或删除 Pod 对象即可，Pod Controller 会立即关注到这些改动并实际创建出所需的 Container 以完成它的工作。在这个过程中 API Server 提供了在数据库中创建、删除和修改对象的统一接口，但实际工作是由 Controller 完成的。实际上这种通过 Object 的交互是 Controller 之间协作的普遍方式（如 Deployment 与 ReplicaSet 的协作）。...</p>
  </section>
  <footer class="entry-footer">
    <time>October 3, 2020</time>&nbsp;·&nbsp;18 min&nbsp;·&nbsp;Zhengrui Qin
  </footer>
  <a class="entry-link" aria-label="post link to Kubernetes Controller：从 ReplicaSet 开始" href="https://MilesChing.github.io/posts/kubernetes/replicaset-src/"></a>
</article>

    </main><footer class="footer">
    <span>&copy; 2020 <a href="https://MilesChing.github.io/">MilesChing</a></span>
    <span>&middot;</span>
    <span>Powered by <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo️️</a>️</span>
    <span>&middot;</span>
    <span>Theme️ <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top">
    <button class="top-link" id="top-link" type="button">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6">
            <path d="M12 6H0l6-6z" /></svg>
    </button>
</a>
<script>
    window.onload = function () {
        if (localStorage.getItem("menu-scroll-position")) {
            document.getElementById('menu').scrollLeft = localStorage.getItem("menu-scroll-position");
        }
    }
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();

            document.querySelector(this.getAttribute("href")).scrollIntoView({
                behavior: "smooth"
            });
        });
    });
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
    function menu_on_scroll() {
        localStorage.setItem("menu-scroll-position", document.getElementById('menu').scrollLeft);
    }
</script>
</body>

</html>